<template name="priceAnalysis">
  <div class="{styles.priceAnalysis}">
    <!--查询条件-->
    <conditions {onSearch} showCategory showBrand showDate  defaultValueType=3 />
    <div class="{styles.pageCnt}">
      <h2 class="{styles.pageTitle}">价格敏感度分析</h2>
      <priceAnalysisSummary />
      <div class="{styles.pageTitleBox}">
        <h2 class="{styles.pageTitle}">商品价格敏感度</h2>
        <span>销量band低的低价格敏感度商品可以进行适当调价，以达到效益的最大化</span>
      </div>
      <priceAnalysisProduct />
      <priceAnalysisList />
    </div>
  </div>
</template>

<template name="priceAnalysisSummary">
  <fj-Row class="{styles.summary} clearfix">
    <fj-Col l="2">
        <span class="{styles.imgBox}"><img src="{iconGraph}" alt=""></span>
    </fj-Col>
    <fj-Col l="10">
        <div class="{styles.txtarea}">
          <h3>价格敏感度</h3>
          <p>1. 高价格弹性：价格弹性表示商品的销量变化率与价格的变化率的比值，价格弹性高说明价格稍微变动引起较大的销量变化。</p>
          <p>2. 高定价band（KVI商品）：定价band综合考虑商品的销量和流量，通过加权来计算每个商品的得分后进行排序，排序靠前的商品，消费者相对更加熟悉，对价格感知强，属于高定价band。</p>
          <p>3. 条件1/2同时满足，定义为高价格敏感度的商品。</p>
        </div>
    </fj-Col>
  </fj-Row>
</template>

<template name="priceAnalysisProduct">
  <div class="{styles.products}">
      <!-- <#if {priceAnalysis.priceProductSuccess == (true)}> -->
        <div class="{styles.yAxis}">
           <span class="{styles.sup}">高</span>
           <span class="{styles.txt}">商品价格敏感度</span>
           <span class="{styles.sub}">低</span>
        </div>
        <ec-BarChart ref="ecProducts" option={barProductsOption} data={barProductsData} height={420} />
        <!-- <#else>
           <div class="{styles.errorTip}">
                <span class="{styles.txt}">暂无数据！</span>
           </div>
        </#else>
      </#if> -->

  </div>
</template>

<template name="priceAnalysisList">
  <div class="{styles.detail}">
      <div class="{styles.title}">
          <form action={formAction} target="ifrExport" method="post" ref="formExport">
             <a href="javascript:;" class="{styles.btnDown}" onClick={onDownload}><ant-Icon type="download" /></a>
            <input type="hidden" name="categoryId1" value="{categoryId1}">
            <input type="hidden" name="categoryId2" value="{categoryId2}">
            <input type="hidden" name="categoryId3" value="{categoryId3}">
            <input type="hidden" name="brandId" value="{brandId}">
            <input type="hidden" name="date" value="{date}">
            <input type="hidden" name="saleBand" value="{priceAnalysis.saleBand}">
            <input type="hidden" name="sensitivity" value="{priceAnalysis.sensitivity}">
            <iframe style="display:none" id="ifrExport" name="ifrExport" src="about:blank"></iframe>
          </form>
          <#if {priceAnalysis.bandIndex ==(0)}>
               <h2 class="{styles.pageTitle}">销量{priceAnalysis.saleBand} band 价格敏感度高的商品</h2>
               <#else>
                  <h2 class="{styles.pageTitle}">销量{priceAnalysis.saleBand} band 价格敏感度低的商品</h2>
               </#else>
           </#if>

      </div>
          <table class="{styles.tableDetail}">
              <thead>
                  <tr>
                      <td>排名</td>
                      <td>商品名称</td>
                      <td>SKU编码</td>
                      <td>销量band</td>
                      <td>GMVband</td>
                      <td>点击band</td>
                      <td>KV定价band</td>
                      <td>商品价格弹性</td>
                      <td>价格敏感度</td>
                  </tr>
              </thead>
              <tbody>
                 <#each {priceAnalysis.priceProductsList}>
                    <tr key={@index}>
                       <#if {@index <(3)}>
                          <#if {priceAnalysis.priceCurrentPage ==(1)}>
                            <td class="{styles.rank}">{rank}</td>
                            <#else>
                              <td>{rank}</td>
                            </#else>
                          </#if>
                         <#else>
                           <td>{rank}</td>
                         </#else>
                       </#if>
                       <td>{skuName}</td>
                       <td>{skuId}</td>
                       <td>{saleBand}</td>
                       <td>{gmvBand}</td>
                       <td>{clickBand}</td>
                       <td>{kvBand}</td>
                       <#if {ec != (0)}>
                         <td>{ec.('toFixed')_(2)}</td>
                         <#else>
                            <td>{ec}</td>
                         </#else>
                       </#if>
                       <td>{sensitivity}</td>
                    </tr>
                  </#each>
              </tbody>
          </table>
          <#if {priceAnalysis.priceProductsListCount >(0)}>
          <div class="{styles.paginationWrap}">
            <ant-Pagination current={priceAnalysis.priceCurrentPage} total={priceAnalysis.priceProductsListCount} onChange={onPaging} />
          </div>
          </#if>
  </div>
</template>
